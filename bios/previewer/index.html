<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Chaturbate Bio Previewer - Test Your Custom Bio Design • Shabito</title>
    <meta name="description" content="Free Chaturbate bio previewer tool. Test and preview your custom Chaturbate bio design before going live. See exactly how your bio will look on desktop and mobile. Mobile-friendly bio tester by Shabito." />
    <style>
      * {
        box-sizing: border-box;
      }
      body {
        margin: 0;
        font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial,
          sans-serif;
      }
      .app {
        height: 100vh;
        display: grid;
        grid-template-columns: 520px 1fr;
        overflow: hidden;
      }
      .left {
        border-right: 1px solid #ddd;
        padding: 12px;
        overflow: auto;
      }
      .right {
        overflow: hidden;
      }
      h1 {
        font-size: 14px;
        margin: 0 0 8px;
        font-weight: 650;
      }
      h2 {
        font-size: 13px;
        margin: 12px 0 6px;
        font-weight: 650;
      }
      .guide {
        font-size: 12px;
        line-height: 1.4;
        background: #f9f9f9;
        border: 1px solid #e5e5e5;
        border-radius: 10px;
        padding: 10px;
        margin-bottom: 10px;
      }
      .guide ol {
        margin: 6px 0 0 18px;
        padding: 0;
      }
      .guide li {
        margin-bottom: 4px;
      }
      .mono {
        font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas,
          monospace;
      }
      .row {
        display: flex;
        gap: 8px;
        flex-wrap: wrap;
        align-items: center;
        margin: 10px 0;
      }
      button {
        appearance: none;
        border: 1px solid #ccc;
        background: #f7f7f7;
        padding: 8px 10px;
        border-radius: 8px;
        font-size: 13px;
        cursor: pointer;
      }
      button:hover {
        background: #efefef;
      }
      textarea {
        width: 100%;
        border: 1px solid #ddd;
        border-radius: 10px;
        padding: 10px;
        font-family: ui-monospace, monospace;
        font-size: 12px;
        line-height: 1.35;
        outline: none;
      }
      #pageHtml {
        height: 32vh;
      }
      #bioHtml {
        height: 22vh;
      }
      iframe {
        width: 100%;
        height: 100%;
        border: 0;
        background: white;
      }
      .status {
        font-size: 12px;
        padding: 8px 10px;
        border-radius: 10px;
        margin-top: 10px;
        background: #fafafa;
        border: 1px solid #eee;
        white-space: pre-wrap;
      }
      .good {
        border-color: #c8e6c9;
        background: #f7fff7;
        color: #1b5e20;
      }
      .bad {
        border-color: #f2c2c2;
        background: #fff7f7;
        color: #7a1b1b;
      }
      label.check {
        font-size: 12px;
        color: #444;
        display: inline-flex;
        gap: 6px;
        align-items: center;
      }
    </style>
  </head>
  <body>
    <div class="app">
      <div class="left">
        <h1>Chaturbate Bio Previewer</h1>

        <!-- STEP-BY-STEP GUIDE -->
        <details class="guide">
          <summary><strong>How to use this tool</strong></summary>
          <ol>
            <li>
              Open the real Chaturbate profile in your browser and pass the age
              gate.
            </li>
            <li>
              Switch to the <b>Bio</b> tab so the “About me” section is visible.
            </li>
            <li>
              Open DevTools → Console and run:<br />
              <span class="mono"
                >copy('&lt;!doctype html&gt;\n' +
                document.documentElement.outerHTML)</span
              >
            </li>
            <li>Paste the copied output into <b>Page HTML</b> below.</li>
            <li>Paste your bio markup into <b>Bio HTML</b>.</li>
            <li>Click <b>Render</b> to preview.</li>
            <li>
              Click <b>Minimize Bio</b> to get a single-line HTML string ready
              for Chaturbate.
            </li>
          </ol>
          <div style="margin-top: 6px">
            Target insertion point:
            <span class="mono">div[data-testid="bio-tab-about-me-value"]</span>
          </div>
        </details>

        <!-- ACTIONS -->
        <div class="row">
          <button id="render">Render</button>
          <button id="minify">Minimize Bio</button>
          <button id="copyBio">Copy Bio</button>
          <button id="clear">Clear</button>
        </div>

        <div class="row">
          <label class="check"
            ><input id="stripScripts" type="checkbox" checked />Strip
            &lt;script&gt;</label
          >
          <label class="check"
            ><input id="sanitizeBio" type="checkbox" checked />Sanitize
            bio</label
          >
        </div>

        <!-- INPUTS -->
        <details>
          <summary style="font-size: 12px; margin-bottom: 4px">
            <b>Page HTML</b>
          </summary>
          <textarea id="pageHtml" spellcheck="false"></textarea>
        </details>

        <div style="margin-top: 8px">
          <div style="font-size: 12px; margin-bottom: 4px"><b>Bio HTML</b></div>
          <textarea id="bioHtml" spellcheck="false"></textarea>
        </div>

        <div id="status" class="status">Ready.</div>
      </div>

      <div class="right">
        <iframe
          id="frame"
          sandbox="allow-forms allow-popups allow-same-origin"
        ></iframe>
      </div>
    </div>

    <script>
      const $ = (id) => document.getElementById(id);

      function setStatus(msg, cls) {
        $("status").textContent = msg;
        $("status").className = "status" + (cls ? " " + cls : "");
      }

      function stripScripts(html) {
        return html.replace(/<script\b[^>]*>[\s\S]*?<\/script>/gi, "");
      }

      function sanitizeBio(html) {
        const doc = new DOMParser().parseFromString(
          `<div>${html}</div>`,
          "text/html"
        );
        doc.querySelectorAll("*").forEach((el) => {
          [...el.attributes].forEach((a) => {
            if (a.name.startsWith("on")) el.removeAttribute(a.name);
            if (
              (a.name === "href" || a.name === "src") &&
              a.value.startsWith("javascript:")
            ) {
              el.removeAttribute(a.name);
            }
          });
        });
        return doc.body.firstElementChild.innerHTML;
      }

      function minifyHtml(html) {
        return html
          .replace(/[\n\r\t]+/g, " ")
          .replace(/\s{2,}/g, " ")
          .replace(/>\s+</g, "><")
          .trim();
      }

      function render() {
        let tpl = $("pageHtml").value.trim();
        let bio = $("bioHtml").value;

        if (!tpl) {
          setStatus("Missing Page HTML.", "bad");
          return;
        }

        if ($("stripScripts").checked) tpl = stripScripts(tpl);
        if ($("sanitizeBio").checked) bio = sanitizeBio(bio);

        const doc = new DOMParser().parseFromString(tpl, "text/html");
        const target = doc.querySelector(
          'div[data-testid="bio-tab-about-me-value"]'
        );

        if (!target) {
          $("frame").srcdoc = tpl;
          setStatus("Target div not found in Page HTML.", "bad");
          return;
        }

        target.innerHTML = bio;
        $("frame").srcdoc = "<!doctype html>\n" + doc.documentElement.outerHTML;
        setStatus("Rendered successfully.", "good");
      }

      async function copyToClipboard(text) {
        // Modern API (requires secure context: https:// or localhost)
        if (navigator.clipboard && window.isSecureContext) {
          await navigator.clipboard.writeText(text);
          return;
        }

        // Fallback for file:// or older browsers
        const ta = document.createElement("textarea");
        ta.value = text;
        ta.setAttribute("readonly", "");
        ta.style.position = "fixed";
        ta.style.left = "-9999px";
        ta.style.top = "0";
        document.body.appendChild(ta);
        ta.select();
        ta.setSelectionRange(0, ta.value.length);
        const ok = document.execCommand("copy");
        document.body.removeChild(ta);
        if (!ok) throw new Error("execCommand copy failed");
      }

      $("render").onclick = render;

      $("minify").onclick = () => {
        $("bioHtml").value = minifyHtml($("bioHtml").value);
        setStatus("Bio HTML minimized to single line.", "good");
      };

      $("copyBio").onclick = async () => {
        const text = $("bioHtml").value ?? "";
        try {
          await copyToClipboard(text);
          setStatus("Copied Bio HTML to clipboard.", "good");
        } catch (e) {
          setStatus(
            "Copy failed. Browser blocked clipboard access in this context.",
            "bad"
          );
        }
      };

      $("clear").onclick = () => {
        $("pageHtml").value = "";
        $("bioHtml").value = "";
        $("frame").srcdoc = "";
        setStatus("Cleared.");
      };

      $("bioHtml").value = `<div>
  <h3>Example</h3>
  <p>Bio preview</p>
</div>`;
    </script>
  </body>
</html>
